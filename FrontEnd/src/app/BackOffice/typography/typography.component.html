<div class="main-content" >
  <div class="container-fluid">
      <div class="row">
          
                  <div class="content">

                    
                      
                      


                    <div class="main-content">
                      <div class="container-fluid">
                          <div class="row">
                              <div class="col-md-12">
                                  <div class="card shadow-lg">
                                      <div class="card-header bg-gradient-warning text-dark py-3">
                                          <h4 class="title mb-0">Task Management Dashboard</h4>
                                          <p class="category mb-0">Overview of all tasks and their status</p>
                                      </div>
                                      <div class="card-body">
                                          <div class="table-responsive">
                                              <table class="table table-hover">
                                                  <thead class="bg-light">
                                                      <tr>
                                                          <th>ID</th>
                                                          <th>Name</th>
                                                          <th>Description</th>
                                                          <th>Status</th>
                                                          <th>Priority</th>
                                                          <th>Start Date</th>
                                                          <th>End Date</th>
                                                          <th>Project</th>
                                                          <th>Assignee</th>
                                                      </tr>
                                                  </thead>
                                                  <tbody>
                                                      <tr *ngFor="let tache of displayedTaches" 
                                                          (dblclick)="showTaskDetails(tache)"
                                                          class="task-row">
                                                          <td>{{ tache.id }}</td>
                                                          <td class="font-weight-bold">{{ tache.nom || tache.titre }}</td>
                                                          <td>
                                                              <div class="description-cell">
                                                                  {{ tache.description }}
                                                                  <button class="btn btn-sm btn-outline-warning analyze-btn" 
                                                                          (click)="analyzeDescription(tache)">
                                                                      <i class="fas fa-robot me-1"></i> Analyze
                                                                  </button>
                                                              </div>
                                                          </td>
                                                          <td>
                                                              <span class="status-badge" [ngClass]="'status-' + tache.statut">
                                                                  {{ tache.statut }}
                                                              </span>
                                                          </td>
                                                          <td>
                                                              <span class="priority-badge" [ngClass]="'priority-' + tache.priorite">
                                                                  {{ tache.priorite }}
                                                              </span>
                                                          </td>
                                                          <td>{{ tache.dateDebut | date:'short' }}</td>
                                                          <td>{{ tache.dateFin | date:'short' }}</td>
                                                          <td>
                                                              <span class="project-badge">
                                                                  #{{ tache.projet.id }}
                                                              </span>
                                                          </td>
                                                          <td>
                                                              <span class="assignee-badge">
                                                                  #{{ tache.responsable.id }}
                                                              </span>
                                                          </td>
                                                      </tr>
                                                  </tbody>
                                              </table>
                                          </div>
                  
                                          <!-- Pagination -->
                                          <div class="d-flex justify-content-center mt-4">
                                              <div class="pagination-controls">
                                                  <button class="btn btn-outline-warning me-2" 
                                                          (click)="goToPreviousPage()" 
                                                          [disabled]="currentPage === 1">
                                                      <i class="fas fa-chevron-left"></i>
                                                  </button>
                                                  <span class="pagination-info mx-3">
                                                      Page {{ currentPage }} of {{ totalPages }}
                                                  </span>
                                                  <button class="btn btn-outline-warning ms-2" 
                                                          (click)="goToNextPage()" 
                                                          [disabled]="currentPage === totalPages">
                                                      <i class="fas fa-chevron-right"></i>
                                                  </button>
                                              </div>
                                          </div>
                                      </div>
                                  </div>
                              </div>
                          </div>
                      </div>
                  </div>
                  
                  <style>
                  .card {
                      border: none;
                      margin-bottom: 30px;
                      transition: all 0.3s ease;
                  }
                  
                  .bg-gradient-warning {
                      background: linear-gradient(45deg, #FFC107 0%, #FFD700 100%);
                  }
                  
                  .table {
                      margin-bottom: 0;
                  }
                  
                  .table thead th {
                      border-top: none;
                      font-weight: 600;
                      text-transform: uppercase;
                      font-size: 0.875rem;
                      padding: 1rem;
                  }
                  
                  .task-row {
                      cursor: pointer;
                      transition: all 0.2s ease;
                  }
                  
                  .task-row:hover {
                      background-color: #FFF8DC;
                      transform: translateY(-2px);
                  }
                  
                  .description-cell {
                      display: flex;
                      align-items: center;
                      gap: 10px;
                  }
                  
                  .analyze-btn {
                      padding: 0.25rem 0.5rem;
                      font-size: 0.875rem;
                  }
                  
                  .status-badge, .priority-badge, .project-badge, .assignee-badge {
                      padding: 0.35rem 0.75rem;
                      border-radius: 50rem;
                      font-size: 0.875rem;
                      font-weight: 500;
                      display: inline-block;
                  }
                  
                  /* Status badges */
                  .status-A_FAIRE {
                      background-color: #FFF3CD;
                      color: #856404;
                  }
                  
                  .status-EN_COURS {
                      background-color: #CCE5FF;
                      color: #004085;
                  }
                  
                  .status-TERMINE {
                      background-color: #D4EDDA;
                      color: #155724;
                  }
                  
                  /* Priority badges */
                  .priority-BASSE {
                      background-color: #D4EDDA;
                      color: #155724;
                  }
                  
                  .priority-MOYENNE {
                      background-color: #FFF3CD;
                      color: #856404;
                  }
                  
                  .priority-ELEVEE {
                      background-color: #F8D7DA;
                      color: #721C24;
                  }
                  
                  .project-badge, .assignee-badge {
                      background-color: #E2E3E5;
                      color: #383D41;
                  }
                  
                  .pagination-controls {
                      display: flex;
                      align-items: center;
                      background: white;
                      padding: 0.5rem;
                      border-radius: 50rem;
                      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
                  }
                  
                  .pagination-info {
                      font-weight: 500;
                      color: #6C757D;
                  }
                  
                  /* Responsive adjustments */
                  @media (max-width: 768px) {
                      .table-responsive {
                          border: none;
                      }
                      
                      .card-header {
                          text-align: center;
                      }
                      
                      .pagination-controls {
                          flex-direction: column;
                          gap: 10px;
                      }
                  }
                  </style>

<!-- Modal de détails -->
<!-- Task Details Modal -->
<div class="modal-overlay" *ngIf="selectedTache" (click)="closeDetails()">
  <div class="modal-content task-details" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>
        <i class="fas fa-tasks me-2"></i>
        Task Details
      </h2>
      <button class="close-btn" (click)="closeDetails()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <div class="modal-body">
      <div class="task-info-grid">
        <!-- Basic Info Section -->
        <div class="info-section">
          <h3>Basic Information</h3>
          <div class="info-group">
            <label>Name:</label>
            <p>{{ selectedTache?.nom || selectedTache?.titre }}</p>
          </div>
          <div class="info-group">
            <label>Description:</label>
            <p class="description">{{ selectedTache?.description }}</p>
          </div>
        </div>

        <!-- Status Section -->
        <div class="info-section">
          <h3>Status Information</h3>
          <div class="info-group">
            <label>Status:</label>
            <span class="status-badge" [ngClass]="'status-' + selectedTache?.statut">
              {{ selectedTache?.statut }}
            </span>
          </div>
          <div class="info-group">
            <label>Priority:</label>
            <span class="priority-badge" [ngClass]="'priority-' + selectedTache?.priorite">
              {{ selectedTache?.priorite }}
            </span>
          </div>
        </div>

        <!-- Dates Section -->
        <div class="info-section">
          <h3>Timeline</h3>
          <div class="info-group">
            <label>Start Date:</label>
            <p>{{ selectedTache?.dateDebut | date:'medium' }}</p>
          </div>
          <div class="info-group">
            <label>End Date:</label>
            <p>{{ selectedTache?.dateFin | date:'medium' }}</p>
          </div>
        </div>

        <!-- Assignment Section -->
        <div class="info-section">
          <h3>Assignment Details</h3>
          <div class="info-group">
            <label>Project:</label>
            <span class="project-badge">Project #{{ selectedTache?.projet?.id }}</span>
          </div>
          <div class="info-group">
            <label>Assignee:</label>
            <span class="assignee-badge">User #{{ selectedTache?.responsable?.id }}</span>
          </div>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="modal-actions">
    
     
        <button class="action-btn pdf-btn" (click)="generatePDF(selectedTache)">
          <i class="fas fa-file-pdf me-2"></i>Export PDF
        </button>
      </div>
    </div>
  </div>
</div>

<style>
.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.5);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1000;
  backdrop-filter: blur(5px);
}

.modal-content.task-details {
  background: white;
  border-radius: 15px;
  width: 90%;
  max-width: 800px;
  max-height: 90vh;
  overflow-y: auto;
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
}

.modal-header {
  background: linear-gradient(45deg, #FFC107 0%, #FFD700 100%);
  padding: 20px;
  border-radius: 15px 15px 0 0;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.modal-header h2 {
  color: #8B4513;
  margin: 0;
  font-size: 1.5rem;
  display: flex;
  align-items: center;
}

.close-btn {
  background: none;
  border: none;
  color: #8B4513;
  font-size: 1.5rem;
  cursor: pointer;
  transition: transform 0.3s ease;
}

.close-btn:hover {
  transform: rotate(90deg);
}

.modal-body {
  padding: 25px;
}

.task-info-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 20px;
  margin-bottom: 25px;
}

.info-section {
  background: #FFF8DC;
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.05);
}

.info-section h3 {
  color: #8B4513;
  font-size: 1.1rem;
  margin-bottom: 15px;
  border-bottom: 2px solid #FFD700;
  padding-bottom: 8px;
}

.info-group {
  margin-bottom: 15px;
}

.info-group label {
  display: block;
  color: #666;
  font-size: 0.9rem;
  margin-bottom: 5px;
}

.info-group p {
  margin: 0;
  color: #333;
  font-size: 1rem;
}

.description {
  white-space: pre-wrap;
  background: white;
  padding: 10px;
  border-radius: 5px;
  border: 1px solid #FFE4B5;
}

.modal-actions {
  display: flex;
  gap: 10px;
  justify-content: flex-end;
  margin-top: 20px;
  padding-top: 20px;
  border-top: 1px solid #FFE4B5;
}

.action-btn {
  padding: 10px 20px;
  border: none;
  border-radius: 25px;
  cursor: pointer;
  font-weight: 500;
  display: flex;
  align-items: center;
  transition: all 0.3s ease;
}

.edit-btn {
  background: #FFC107;
  color: #8B4513;
}

.delete-btn {
  background: #8B4513;
  color: white;
}

.pdf-btn {
  background: #DAA520;
  color: white;
}

.action-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

@media (max-width: 768px) {
  .task-info-grid {
    grid-template-columns: 1fr;
  }

  .modal-actions {
    flex-direction: column;
  }

  .action-btn {
    width: 100%;
    justify-content: center;
  }
}
</style>
<!-- JavaScript Libraries -->
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
<script src="lib/easing/easing.min.js"></script>
<script src="lib/wow/wow.min.js"></script>
<script src="lib/owlcarousel/owl.carousel.min.js"></script>
<script src="lib/isotope/isotope.pkgd.min.js"></script>
<script src="lib/lightbox/js/lightbox.min.js"></script>
<script src="lib/waypoints/waypoints.min.js"></script>
<script src="lib/counterup/counterup.min.js"></script>
<script src="lib/slick/slick.min.js"></script>

<!-- Template Javascript -->
<script src="js/main.js"></script>

<style>
.search-container {
  margin: 20px 0;
  position: relative;
}

.search-input-wrapper {
  position: relative;
  width: 100%;
  max-width: 500px;
  margin: 0 auto;
}

.search-input {
  width: 100%;
  padding: 12px 40px 12px 40px;
  border: 2px solid #ddd;
  border-radius: 25px;
  font-size: 16px;
  transition: all 0.3s ease;
}

.search-input:focus {
  border-color: #007bff;
  box-shadow: 0 0 0 3px rgba(0,123,255,0.25);
  outline: none;
}

.search-icon {
  position: absolute;
  left: 15px;
  top: 50%;
  transform: translateY(-50%);
  color: #666;
}

.search-spinner {
  position: absolute;
  right: 15px;
  top: 50%;
  transform: translateY(-50%);
  color: #007bff;
}

.search-status {
  text-align: center;
  margin-top: 20px;
  color: #666;
}

.icon-button {
  background: none;
  border: none;
  padding: 5px;
  cursor: pointer;
  transition: all 0.3s ease;
  margin: 0 3px;
}

.icon-button:hover {
  transform: translateY(-2px);
}

.icon-button.delete:hover {
  color: #dc3545;
}

.icon-button.pdf {
  color: #e74c3c;
}

.icon-button.pdf:hover {
  color: #c0392b;
}

@keyframes pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.1); }
  100% { transform: scale(1); }
}

.icon-button.pdf:active {
  animation: pulse 0.3s ease-in-out;
}
</style>

<div class="analysis-results" *ngIf="taskAnalysis">
<h3>Analyse de la tâche</h3>

<!-- Étapes détectées -->
<div class="analysis-section">
  <h4>Étapes détectées ({{ taskAnalysis.steps.length }})</h4>
  <ul class="steps-list">
    <li *ngFor="let step of taskAnalysis.steps">
      {{ step }}
    </li>
  </ul>
  <p *ngIf="taskAnalysis.steps.length === 0">
    Aucune étape détectée. Essayez d'utiliser des marqueurs comme "1.", "-", ou "étape".
  </p>
</div>

<!-- Complexité et durée -->
<div class="analysis-section">
  <h4>Évaluation</h4>
  
  <p class="duration">
    Durée estimée: {{ taskAnalysis.estimatedDuration }} heures
  </p>
</div>

<!-- Mots-clés techniques -->
<div class="analysis-section">
  <h4>Mots-clés techniques détectés</h4>
  <div class="keywords">
    <span class="keyword" *ngFor="let keyword of taskAnalysis.keywords">
      {{ keyword }}
    </span>
  </div>
</div>

<!-- Suggestions -->
<div class="analysis-section">
  <h4>Suggestions</h4>
  <ul class="suggestions-list">
    <li *ngFor="let suggestion of taskAnalysis.suggestions">
      {{ suggestion }}
    </li>
  </ul>
</div>
</div>

<style>
.task-analysis-container {
margin: 20px;
padding: 20px;
border-radius: 8px;
background-color: #f8f9fa;
}

.analyze-btn {
background-color: #6c757d;
color: white;
border: none;
padding: 4px 8px;
border-radius: 4px;
cursor: pointer;
font-size: 0.8em;
margin-left: 8px;
display: inline-flex;
align-items: center;
gap: 4px;
}

.analyze-btn:hover {
background-color: #5a6268;
}

.analysis-results {
margin: 20px;
padding: 20px;
border: 1px solid #dee2e6;
border-radius: 8px;
background-color: white;
box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.analysis-section {
margin-bottom: 20px;
}

.analysis-section h4 {
color: #495057;
margin-bottom: 10px;
}

.steps-list {
list-style-type: none;
padding-left: 0;
}

.steps-list li {
padding: 8px;
margin-bottom: 5px;
background-color: #f8f9fa;
border-radius: 4px;
}

.complexity {
font-weight: bold;
}

.complexity span {
padding: 3px 8px;
border-radius: 4px;
}

.complexity .simple { background-color: #28a745; color: white; }
.complexity .moyenne { background-color: #ffc107; color: black; }
.complexity .complexe { background-color: #dc3545; color: white; }

.keywords {
display: flex;
flex-wrap: wrap;
gap: 8px;
}

.keyword {
background-color: #e9ecef;
padding: 4px 8px;
border-radius: 4px;
font-size: 0.9em;
}

.suggestions-list {
list-style-type: none;
padding-left: 0;
}

.suggestions-list li {
padding: 8px;
margin-bottom: 5px;
border-left: 3px solid #007bff;
background-color: #f8f9fa;
}
</style>

<!-- Ajouter un modal pour l'analyse -->
<div class="modal-overlay" *ngIf="taskAnalysis" (click)="closeAnalysis()">
<div class="modal-content" (click)="$event.stopPropagation()">
  <div class="modal-header">
    <h3>Analyse de la Tâche</h3>
    <button class="close-btn" (click)="closeAnalysis()">
      <i class="fas fa-times"></i>
    </button>
  </div>

  <div class="modal-body">
    <!-- Résumé rapide -->
    <div class="quick-summary">
      <div class="summary-item">
        <i class="fas fa-list"></i>
        <span>{{ taskAnalysis.steps.length }} étapes</span>
      </div>
      <div class="summary-item">
        <i class="fas fa-clock"></i>
        <span>{{ taskAnalysis.estimatedDuration }}h estimées</span>
      </div>
      <div class="summary-item">
        <i class="fas fa-chart-line"></i>
        
      </div>
    </div>

    <!-- Étapes détectées -->
    <div class="analysis-section">
      <h4><i class="fas fa-tasks"></i> Étapes détectées</h4>
      <div class="steps-container">
        <div class="step-item" *ngFor="let step of taskAnalysis.steps; let i = index">
          <span class="step-number">{{ i + 1 }}</span>
          <span class="step-text">{{ step }}</span>
        </div>
        <p *ngIf="taskAnalysis.steps.length === 0" class="no-steps">
          <i class="fas fa-info-circle"></i>
          Aucune étape détectée. Essayez d'utiliser des marqueurs comme "1.", "-", ou "étape".
        </p>
      </div>
    </div>

    <!-- Mots-clés techniques -->
    <div class="analysis-section">
      <h4><i class="fas fa-tags"></i> Mots-clés techniques</h4>
      <div class="keywords-container">
        <span class="keyword-tag" *ngFor="let keyword of taskAnalysis.keywords">
          <i class="fas fa-code"></i> {{ keyword }}
        </span>
        <p *ngIf="taskAnalysis.keywords.length === 0" class="no-keywords">
          Aucun mot-clé technique détecté
        </p>
      </div>
    </div>

    <!-- Suggestions -->
    <div class="analysis-section">
      <h4><i class="fas fa-lightbulb"></i> Suggestions</h4>
      <div class="suggestions-container">
        <div class="suggestion-item" *ngFor="let suggestion of taskAnalysis.suggestions">
          {{ suggestion }}
        </div>
      </div>
    </div>
  </div>
</div>
</div>

<style>
/* Styles pour le modal */
.modal-overlay {
position: fixed;
top: 0;
left: 0;
right: 0;
bottom: 0;
background-color: rgba(0, 0, 0, 0.5);
display: flex;
justify-content: center;
align-items: center;
z-index: 1000;
}

.modal-content {
background: white;
border-radius: 8px;
width: 90%;
max-width: 800px;
max-height: 90vh;
overflow-y: auto;
box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
}

.modal-header {
display: flex;
justify-content: space-between;
align-items: center;
padding: 20px;
border-bottom: 1px solid #eee;
}

.modal-header h3 {
margin: 0;
color: #2c3e50;
}

.close-btn {
background: none;
border: none;
font-size: 1.5em;
cursor: pointer;
color: #666;
}

.modal-body {
padding: 20px;
}

/* Résumé rapide */
.quick-summary {
display: flex;
justify-content: space-around;
padding: 20px;
background: #f8f9fa;
border-radius: 8px;
margin-bottom: 20px;
}

.summary-item {
display: flex;
align-items: center;
gap: 10px;
}

.complexity-badge {
padding: 4px 12px;
border-radius: 20px;
font-weight: 500;
}

.simple { background-color: #28a745; color: white; }
.moyenne { background-color: #ffc107; color: black; }
.complexe { background-color: #dc3545; color: white; }

/* Sections d'analyse */
.analysis-section {
margin-bottom: 30px;
}

.analysis-section h4 {
display: flex;
align-items: center;
gap: 10px;
color: #2c3e50;
margin-bottom: 15px;
}

/* Étapes */
.steps-container {
display: flex;
flex-direction: column;
gap: 10px;
}

.step-item {
display: flex;
align-items: center;
gap: 15px;
padding: 10px;
background: #f8f9fa;
border-radius: 6px;
transition: transform 0.2s;
}

.step-item:hover {
transform: translateX(5px);
}

.step-number {
background: #007bff;
color: white;
width: 24px;
height: 24px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
font-weight: bold;
}

/* Mots-clés */
.keywords-container {
display: flex;
flex-wrap: wrap;
gap: 10px;
}

.keyword-tag {
background: #e9ecef;
padding: 6px 12px;
border-radius: 20px;
display: flex;
align-items: center;
gap: 6px;
font-size: 0.9em;
}

/* Suggestions */
.suggestions-container {
display: flex;
flex-direction: column;
gap: 10px;
}

.suggestion-item {
padding: 10px 15px;
background: #f8f9fa;
border-left: 4px solid #007bff;
border-radius: 4px;
}

/* Messages d'absence de données */
.no-steps, .no-keywords {
color: #6c757d;
font-style: italic;
display: flex;
align-items: center;
gap: 8px;
}
</style>

